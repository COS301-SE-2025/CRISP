# CRISP Threat Intelligence Platform - Environment Configuration Template
# Copy this file to .env and fill in your actual values

# =============================================================================
# CRITICAL SECURITY SETTINGS
# =============================================================================

# Master password for internal encryption (CHANGE THIS!)
CRISP_MASTER_PASSWORD=your-secure-master-password-here

# Salt for key derivation (CHANGE THIS!)
CRISP_SALT=your-secure-salt-here

# Environment (development/production)
CRISP_ENVIRONMENT=development

# =============================================================================
# API KEYS AND SECRETS
# =============================================================================

# AlienVault OTX API Key
# Get from: https://otx.alienvault.com/api
OTX_API_KEY=your-otx-api-key-here

# Django Secret Key (generate a new one for production)
DJANGO_SECRET_KEY=your-django-secret-key-here

# JWT Secret Key for token authentication
JWT_SECRET_KEY=your-jwt-secret-key-here

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database password
DATABASE_PASSWORD=your-database-password-here

# Database encryption key for sensitive data
DATABASE_ENCRYPTION_KEY=your-database-encryption-key-here

# =============================================================================
# OAUTH CONFIGURATION
# =============================================================================

# OAuth Client ID and Secret
OAUTH_CLIENT_ID=your-oauth-client-id-here
OAUTH_CLIENT_SECRET=your-oauth-client-secret-here

# =============================================================================
# TAXII AUTHENTICATION
# =============================================================================

# TAXII Authentication Token
TAXII_AUTH_TOKEN=your-taxii-auth-token-here

# TAXII Basic Auth Password
TAXII_BASIC_AUTH_PASSWORD=your-taxii-basic-auth-password-here

# =============================================================================
# SECURITY POLICIES
# =============================================================================

# Session timeout in minutes
SESSION_TIMEOUT_MINUTES=30

# Maximum login attempts before lockout
MAX_LOGIN_ATTEMPTS=5

# Minimum password length
PASSWORD_MIN_LENGTH=12

# Require multi-factor authentication
REQUIRE_MFA=false

# Rate limiting (requests per minute)
RATE_LIMIT_PER_MINUTE=60

# =============================================================================
# AUDIT AND LOGGING
# =============================================================================

# Audit log retention in days
AUDIT_LOG_RETENTION_DAYS=90

# Sensitive data retention in days
SENSITIVE_DATA_RETENTION_DAYS=30

# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# =============================================================================
# STIX/TAXII SETTINGS
# =============================================================================

# Strict STIX validation
STIX_VALIDATION_STRICT=true

# Require authentication for TAXII endpoints
TAXII_REQUIRE_AUTH=true

# Enforce HTTPS for TAXII communications
TAXII_ENFORCE_HTTPS=true

# =============================================================================
# ANONYMIZATION SETTINGS
# =============================================================================

# Default anonymization level (none, partial, full)
DEFAULT_ANONYMIZATION_LEVEL=partial

# Number of hash characters to preserve when anonymizing
PRESERVE_HASH_PREFIXES=8

# Whether to anonymize timestamps
ANONYMIZE_TIMESTAMPS=false

# =============================================================================
# OTX INTEGRATION SETTINGS
# =============================================================================

# Enable OTX integration
OTX_ENABLED=true

# OTX fetch interval in seconds
OTX_FETCH_INTERVAL=3600

# OTX batch size for processing
OTX_BATCH_SIZE=50

# Maximum age of OTX data to fetch (days)
OTX_MAX_AGE_DAYS=30

# Rate limiting delay between OTX requests (seconds)
OTX_RATE_LIMIT_DELAY=1.0

# Auto-create feeds for OTX data
OTX_AUTO_CREATE_FEED=true

# =============================================================================
# ADDITIONAL NOTES
# =============================================================================

# 1. Never commit the actual .env file to version control
# 2. Use strong, unique passwords for all credentials
# 3. Regularly rotate API keys and secrets
# 4. Enable MFA in production environments
# 5. Use HTTPS for all production deployments
# 6. Monitor logs for security events
# 7. Keep audit logs for compliance requirements